!function e(t,n,i){function o(s,a){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(r)return r(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return o(n?n:e)},l,l.exports,e,t,n,i)}return n[s].exports}for(var r="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(e,t,n){!function(t,n){function i(t,n){function i(e){p.init(),p.updateContext(e)}function o(e){l.resetData(),l.updateProperty("originalImage",e),l.updateProperty("croppedImage",{type:e.type,name:e.name}),h.changeFile(e)}function r(){return l.updateDataFor("croppedImage"),l.getImageData()}function s(){c.removeAll(),a=null}var a={};a.destroy=s,a.getInfo=r;var u=e("./components/settings/settings.js");u.bindSettings(t,n);var c=e("./components/events-queue/events-queue.js"),l=e("./components/information/information.js"),f=e("./components/drag-drop/drag-drop.js"),p=e("./components/crop-window/crop-window.js"),h=e("./components/crop-area/crop-area.js"),d=e("./components/file-upload/file-upload.js");return d.onFileChange(o),f.onFileChange(o),h.onChange(i),a}n.CropResize=i}(document,window)},{"./components/crop-area/crop-area.js":2,"./components/crop-window/crop-window.js":3,"./components/drag-drop/drag-drop.js":4,"./components/events-queue/events-queue.js":5,"./components/file-upload/file-upload.js":6,"./components/information/information.js":7,"./components/settings/settings.js":10}],2:[function(e,t,n){!function(){function n(){function t(){o(),i(),b=!0}function n(e){b||t(),g.fileToBase64(e,function(e){v.updateProperty("originalImage",{src:e,file:g.base64toBlob(e)}),j.src=e})}function i(){j.onload=r,d.subscribe("resize",window,u)}function o(){var e,t=m.cropArea;t&&(e=t.tagName.toLocaleLowerCase(),m.cropArea&&!g.isClosedElement(m.cropArea)&&("canvas"!==e?(l=document.createElement("canvas"),t.appendChild(l)):l=m.cropArea,h=l.getContext("2d")))}function r(e){var t;v.updateProperty("originalImage",{width:this.width,height:this.height}),l.width=l.offsetWidth,l.height=l.offsetHeight,f={},p={},f.width=this.width,f.height=this.height,p.width=l.width,p.height=l.height,t=c(),p.widthRatio=t.asObject.dWidth/p.width,p.heightRatio=t.asObject.dHeight/p.height,h.clearRect(0,0,p.width,p.height),t.asArray.unshift(j),h.drawImage.apply(h,t.asArray),u(),a(t)}function s(e){y.push(e)}function a(e){for(var t=y.length;t--;)y[t]&&"function"==typeof y[t]&&y[t]({source:f,canvas:p,context:h,canvasParams:e})}function u(){if(l&&p){var e=l.getBoundingClientRect();p.top=e.top,p.left=e.left,p.cWidth=l.offsetWidth,p.cHeight=l.offsetHeight}}function c(){var e=p.width/f.width,t=p.height/f.height,n=Math.min(e,t),i={sx:0,sy:0,sWidth:f.width,sHeight:f.height,dx:(p.width-f.width*n)/2,dy:(p.height-f.height*n)/2,dWidth:f.width*n,dHeight:f.height*n};return{asObject:i,asArray:Object.keys(i).map(function(e){return i[e]})}}var l,f,p,h,d=e("../events-queue/events-queue.js"),g=e("../utils/utils.js"),m=e("../settings/settings.js"),v=e("../information/information.js"),w={},b=!1,y=[],j=new Image;return w.changeFile=n,w.onChange=s,w}t.exports=n()}()},{"../events-queue/events-queue.js":5,"../information/information.js":7,"../settings/settings.js":10,"../utils/utils.js":12}],3:[function(e,t,n){!function(){function n(){function t(e){d=e.canvas,g=e.context,c=e.source,f=e.canvasParams,x.setAttribute("style","")}function n(){if(!y){w.onDrag(i),w.onDown(s),w.onUp(a),x.className="cr-crop-window";for(var e=0;e<E.length;e++)!function(){var t=document.createElement("div");t.className="cr-crop-handle cr-"+E[e]["class"],E[e].element=t,x.appendChild(t)}();m.cropArea.appendChild(x),p=x.clientWidth,h=x.clientHeight,m.setRatio&&(m.setRatio.hRatio>m.setRatio.wRatio?h=x.clientWidth*m.setRatio.wRatio:p=x.clientHeight*m.setRatio.hRatio),x.style.height=h+"px",x.style.width=p+"px",y=!0}}function i(e,t){if(b.isHeld||t){var n,i,s=d.cWidth-d.cWidth*d.widthRatio,a=d.cHeight-d.cHeight*d.heightRatio,u=-1*x.offsetLeft+s/2,c=-1*x.offsetTop+a/2,f=x.offsetLeft-(x.clientWidth-p)-s/2,g=x.offsetTop-(x.clientHeight-h)-a/2,m=d.cWidth,v=d.cHeight,w=j.x+e.x,y=j.y+e.y,E=x.offsetWidth,I=x.offsetHeight;u>w&&(w=u),w>f&&(w=f),c>y&&(y=c),y>g&&(y=g),l===x||t?o(j.scaleX,j.skewX,j.skewY,j.scaleY,w,y):(l["class"].match(/left/g)&&(i=m-(m-(j.width+(x.offsetLeft+j.x)))-s/2),l["class"].match(/right/g)&&(i=m-(x.offsetLeft+j.x)-s/2,E=Math.min(j.width+e.x,i)),l["class"].match(/bottom/g)&&(n=v-(x.offsetTop+j.y)-a/2,I=Math.min(j.height+e.y,n)),l["class"].match(/top/g)&&(n=v-(v-(j.height+(x.offsetTop+j.y)))-a/2),l["class"].match(/top-left/g)?(E=Math.min(j.width-e.x,i),I=Math.min(j.height-e.y,n)):l["class"].match(/top/g)?(I=Math.min(j.height-e.y,n),w=j.x):l["class"].match(/left/g)&&(E=Math.min(j.width-e.x,i),y=j.y),E>0&&I>0&&(x.style.width=E,x.style.height=I,l["class"].match(/left|top/g)&&o(j.scaleX,j.skewX,j.skewY,j.scaleY,w,y))),r()}}function o(e,t,n,i,o,r){x.style.transform="matrix("+e+","+t+","+n+","+i+","+o+", "+r+")"}function r(){var e,t=d.cWidth,n=d.cHeight,i=x.clientHeight/n,o=x.clientWidth/t,r=(x.getBoundingClientRect().left-d.left)/t,s=(x.getBoundingClientRect().top-d.top)/n,a=d.width*o,u=d.height*i,c=d.width*r,l=d.height*s;c>0&&l>0&&a>0&&u>0&&(e=g.getImageData(c,l,a,u),v.createImgInstance(e,a,u))}function s(e){if(e.target.className.match("-crop-")){var t=window.getComputedStyle(x).transform.match(/-?\d+(?:\.\d+)?/g)||[];if(b.isHeld=!0,j.scaleX=Number(t[0]||1),j.skewX=Number(t[1]||0),j.skewY=Number(t[2]||0),j.scaleY=Number(t[3]||1),j.x=Number(t[4]||0),j.y=Number(t[5]||0),j.width=x.offsetWidth,j.height=x.offsetHeight,l=null,e.target===x||e.target.className.match(/center-point/gi))l=x;else for(var n=0;n<E.length;n++)if(e.target===E[n].element){l=E[n];break}}}function a(e){b.isHeld=!1,l=null}function u(){function e(e){return{"class":e}}return[e("handle-top-left"),e("handle-top-center"),e("handle-top-right"),e("handle-right-middle"),e("handle-bottom-right"),e("handle-bottom-center"),e("handle-bottom-left"),e("handle-left-middle"),e("center-point")]}var c,l,f,p,h,d,g,m=e("../settings/settings.js"),v=e("../preview/preview.js"),w=e("../mouse-events/mouse-events.js"),b={},y=!1,j={},E=u(),x=document.createElement("div");return b.init=n,b.updateContext=t,b.isHeld=!1,b}t.exports=n()}()},{"../mouse-events/mouse-events.js":8,"../preview/preview.js":9,"../settings/settings.js":10}],4:[function(e,t,n){!function(){function n(){function t(){u.dropArea&&(a.subscribe("drop",u.dropArea,i),a.subscribe("dragover",u.dropArea,o),a.subscribe("dragleave",u.dropArea,s),a.subscribe("dragenter",u.dropArea,r))}function n(e){l.push(e)}function i(e){e.preventDefault();var t=e.dataTransfer.files,n=l.length;if(t[0]instanceof Blob)for(;n--;)l[n]&&"function"==typeof l[n]&&l[n](t[0])}function o(e){c.isHeld||(e.preventDefault(),e.dataTransfer.dropEffect="copy")}function r(e){c.isHeld||u.dropArea.classList.add(p)}function s(e){c.isHeld||u.dropArea.classList.remove(p)}var a=e("../events-queue/events-queue.js"),u=e("../settings/settings.js"),c=e("../crop-window/crop-window.js"),l=[],f={},p="drag-over";return f.onFileChange=n,t(),f}t.exports=n()}()},{"../crop-window/crop-window.js":3,"../events-queue/events-queue.js":5,"../settings/settings.js":10}],5:[function(e,t,n){!function(){function e(){function e(e,t,i){for(var r,s=0;s<o.length;s++)if(o[s].eventName===e&&o[s].element===t){o[s].events.push(i),r=o[s];break}return(r||new n(e,t,i)).publicEvents}function t(e,t){for(var n=o.length;n--;)if(o[n].element===t&&o[n].eventName===e)return void o[n].publicEvents.trigger()}function n(e,t,n){function i(e){for(var t=0;t<a.events.length;t++)a.events[t].call(this,e)}function r(){t.dispatchEvent(u)}function s(){var r=a.events.indexOf(n);r>-1&&a&&a.events.splice(r,1),a.events.length<=0&&(t.removeEventListener(e,i),o.splice(o.indexOf(a),1))}var a={events:[n],element:t,eventName:e,publicEvents:{unSubscribe:s,trigger:r}},u=document.createEvent("Event");return u.initEvent(e,!0,!0),t.addEventListener(e,i),o.push(a),a}function i(){for(var e=o.length;e--;)o[e].publicEvents.unSubscribe()}var o=[],r={};return r.subscribe=e,r.removeAll=i,r.triggerEvent=t,r}t.exports=e()}()},{}],6:[function(e,t,n){!function(){"use strict";function n(){function t(){r.subscribe("change",s.fileInput,o)}function n(e){a.push(e)}function i(e){for(var t=a.length;t--;)a[t]&&"function"==typeof a[t]&&a[t](e)}function o(e){var t=this.files;for(var n in t)if(t[n]instanceof Blob)return i(t[n])}var r=e("../events-queue/events-queue.js"),s=e("../settings/settings.js"),a=[],u={};return t(),u.onFileChange=n,u}t.exports=n()}()},{"../events-queue/events-queue.js":5,"../settings/settings.js":10}],7:[function(e,t,n){!function(){"use strict";function n(){function t(){return{croppedImage:u.croppedImage,originalImage:u.originalImage}}function n(e){var t=u[e];t&&""!==t.src&&(t.file=a.base64toBlob(t.src))}function i(){u={croppedImage:r(),originalImage:r()}}function o(e,t){if(u[e])for(var n in u[e])t[n]&&(u[e][n]=t[n])}function r(){return{src:"",file:null,size:0,type:"",name:"",width:0,height:0}}var s={},a=e("../utils/utils.js"),u={croppedImage:r(),originalImage:r()};return s.getImageData=t,s.updateDataFor=n,s.updateProperty=o,s.resetData=i,s}t.exports=n()}()},{"../utils/utils.js":12}],8:[function(e,t,n){!function(){function n(e,t){function n(){e.subscribe("mousedown",window,l),e.subscribe("mouseup",window,h),e.subscribe("mousemove",window,v),e.subscribe("dragstart",window,f),e.subscribe("dragend",window,d),e.subscribe("drag",window,t(m,50))}function i(e){E.push(e)}function o(e){x.push(e)}function r(e){I.push(e)}function s(){for(var e=0;e<E.length;e++)E[e](q)}function a(e){for(var t=0;t<x.length;t++)x[t](e)}function u(e){for(var t=0;t<I.length;t++)I[t](e)}function c(){return R}function l(e){p(e),R=!0,A=!0}function f(e){p(e),R=!0,C=!0}function p(e){y||(y=e,a(e))}function h(e){A=!1,C||g(e)}function d(e){A=!1,C=!1,g(e)}function g(e){y=null,R=!1,u(e)}function m(e){w(e)}function v(e){C||w(e)}function w(e){R&&(b(y,e),s(e))}function b(e,t){0!==t.x&&(q={x:t.x-e.x,y:t.y-e.y})}var y,j={},E=[],x=[],I=[],R=!1,A=!1,C=!1,q={};return j.isHeld=c,j.onDrag=i,j.onDown=o,j.onUp=r,n(),j}t.exports=n(e("../events-queue/events-queue.js"),e("../throttle/throttle.js"))}()},{"../events-queue/events-queue.js":5,"../throttle/throttle.js":11}],9:[function(e,t,n){!function(){"use strict";function n(){function t(e,t,n){var s,a=document.createElement("canvas"),u=a.getContext("2d");a.width=t,a.height=n,u.putImageData(e,0,0),s=a.toDataURL("image/png",1),s&&(r.updateProperty("croppedImage",{src:s,width:t,height:n}),o.previewElement&&("img"===o.previewElement.tagName.toLowerCase()?o.previewElement.src=s:i.isClosedElement(o.previewElement)||(o.previewElement.style.backgroundImage="url('"+s+"')")))}var n={},i=e("../utils/utils.js"),o=e("../settings/settings.js"),r=e("../information/information.js");return n.createImgInstance=t,n}t.exports=n()}()},{"../information/information.js":7,"../settings/settings.js":10,"../utils/utils.js":12}],10:[function(e,t,n){!function(){function n(){function t(e,t){if(!t.fileInput&&!t.dropArea)throw new TypeError("CropResize is unable to operate without a 'fileInput' or 'dropArea' element.");if(!o.ifValue(e).isElement||!document.querySelector("body").contains(e))throw new TypeError("Invalid 'cropArea' element supplied to cropResize. Please ensure element is available in the DOM.");if(o.isClosedElement(e))throw new TypeError("Unable to add child element canvas to element type '"+e.tagName+"'.");if(r.cropArea=e,t.fileInput){if(!o.ifValue(t.fileInput).isElement||!i.contains(t.fileInput)||"input"!==t.fileInput.tagName.toLowerCase()||"file"!==t.fileInput.type)throw new TypeError("Invalid 'fileInput' element supplied to cropResize. Please ensure element is available in the DOM.");r.fileInput=t.fileInput}if(t.dropArea)if(o.ifValue(t.dropArea).isElement&&i.contains(t.dropArea))r.dropArea=t.dropArea;else{if(t.dropArea!==!0)throw new TypeError("Unable to assign parameter "+t.dropArea+" to 'dropArea'. Please ensure value is an element available in the DOM.");r.dropArea=t.cropArea}if(t.previewElement&&o.ifValue(t.previewElement).isElement&&i.contains(t.previewElement)&&(r.previewElement=t.previewElement),t.setRatio)if("[object Array]"===Object.prototype.toString.call(t.setRatio)){if(!(t.setRatio.length>=2&&"number"==typeof t.setRatio[0]&&"number"==typeof t.setRatio[1]))throw new TypeError("'setRatio' requires and array with two valid number values.");r.setRatio=n(t.setRatio)}else{if("string"!=typeof t.setRatio||!/\d+/gi.test(t.setRatio))throw new TypeError("'setRatio' must be a string containing two numbers separated by any non digit value.");r.setRatio=n(t.setRatio.match(/\d+/gi))}}function n(e){return{hRatio:e[0]/e[1],wRatio:e[1]/e[0]}}var i=document.querySelector("body"),o=e("../utils/utils.js"),r={fileInput:null,cropArea:null,croppedImage:{},dropArea:null,previewElement:null,setRatio:null};return r.bindSettings=t,r}t.exports=n()}()},{"../utils/utils.js":12}],11:[function(e,t,n){!function(){function e(e,t){var n,i=!1;return function(o){i||(e(o),i=!0,n=setTimeout(function(){i=!1},t))}}t.exports=e}()},{}],12:[function(e,t,n){!function(){function e(){function e(e){var t=["Bytes","KB","MB","GB","TB"];if(0==e)return"0 Byte";var n=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,n),2)+" "+t[n]}function t(e,t){function n(e){t(e.target.result)}var i=new FileReader;i.onload=n,i.readAsDataURL(e)}function n(e){for(var t=atob(e.split(",")[1]),n=[],i=0;i<t.length;i++)n.push(t.charCodeAt(i));return new Blob([new Uint8Array(n)],{type:"image/png"})}function i(e){function t(){return"object"==typeof HTMLElement?e instanceof HTMLElement:e&&"object"==typeof e&&null!==e&&1===e.nodeType&&"string"==typeof e.nodeName}return{isElement:t()}}function o(e){var t=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],n=new RegExp("^"+t.join("$|^")+"$","gi");return n.test(e.tagName)}var r={};return r.bytesToSize=e,r.base64toBlob=n,r.ifValue=i,r.isClosedElement=o,r.fileToBase64=t,this.utils=r,r}t.exports=e()}()},{}]},{},[1]);
//# sourceMappingURL=crop-resize-0.1.1.min.js.map
