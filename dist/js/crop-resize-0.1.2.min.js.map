{"version":3,"sources":["crop-resize-0.1.2.js"],"names":["e","t","n","r","s","o","u","a","require","i","f","Error","code","l","exports","call","length",1,"module","document","window","CropResize","cropArea","attributes","updateCropWindow","canvasData","_cropWindow","init","updateContext","onFileProcessed","file","_information","resetData","updateProperty","type","name","_cropArea","changeFile","getInfo","updateDataFor","getImageData","destroy","_eventsQueue","removeAll","_application","_settings","bindSettings","_dragDrop","_fileUpload","onFileChange","onChange","./components/crop-area/crop-area.js","./components/crop-window/crop-window.js","./components/drag-drop/drag-drop.js","./components/events-queue/events-queue.js","./components/file-upload/file-upload.js","./components/information/information.js","./components/settings/settings.js",2,"CropArea","createCanvasElement","bindListeners","_hasInit","_utils","fileToBase64","src","base64toBlob","_image","onload","onCanvasSrcLoad","subscribe","cacheCanvasDimensions","tagName","toLocaleLowerCase","isClosedElement","_canvasElement","createElement","appendChild","_context","getContext","canvasParams","width","this","height","offsetWidth","offsetHeight","_source","_canvas","measureContext","asObject","dWidth","dHeight","clearRect","asArray","unshift","drawImage","apply","notify","storeOnChange","fn","_onChangeQueue","push","totalSubscribers","source","canvas","context","canvasBounding","getBoundingClientRect","top","left","hRatio","vRatio","ratio","Math","min","paramsAsObject","sx","sy","sWidth","sHeight","dx","dy","Object","keys","map","key","_this","Image","../events-queue/events-queue.js","../information/information.js","../settings/settings.js","../utils/utils.js",3,"CropWindowDependencies","cropData","_canvasParams","cropWindowElement","setAttribute","createCropWindow","_mouseEvents","onDrag","onCropMove","onDown","onCropMouseDown","onUp","onCropMouseUp","className","_handles","cropHandle","element","baseWidth","clientWidth","baseHeight","clientHeight","setRatio","wRatio","style","mouseMoveData","force","isHeld","maxHeight","maxWidth","widthOffset","cWidth","widthRatio","heightOffset","cHeight","heightRatio","maxLeft","offsetLeft","maxTop","offsetTop","maxRight","maxBottom","canvasWidth","canvasHeight","newX","_translate","x","newY","y","newWidth","newHeight","_focusElement","applyTransform","scaleX","skewX","skewY","scaleY","match","generatePreviewDimensions","newImgData","heightPercent","widthPercent","leftPercent","topPercent","_preview","createImgInstance","target","transform","getComputedStyle","Number","Handles","handleObject","class","../mouse-events/mouse-events.js","../preview/preview.js",4,"DragDropDependencies","dropArea","onDrop","onDragOver","onDragLeave","onDragEnter","_subscribers","preventDefault","data","dataTransfer","files","Blob","dropEffect","classList","add","focusClassName","remove","../crop-window/crop-window.js",5,"EventsQueue","eventName","subscriberFn","knownQueueItem","_queue","events","EventObject","triggerEvent","publicEvents","trigger","onEvent","queueObject","dispatchEvent","customEvent","unSubscribe","functionIdx","indexOf","splice","removeEventListener","createEvent","initEvent","addEventListener",6,"FileInput","fileInput","onFileInputChange","storeSubscriber","notifySubscribers",7,"Information","croppedImage","_data","originalImage","property","imageInfoObject","values","size",8,"MouseEvents","_throttle","mouseDownHandler","mouseUpHandler","onMouseMoveHandler","onDragStartHandler","onDragEndHandler","onDragHandler","subscribeToDrag","_dragSubscribers","subscribeToDown","_onDownSubscribers","subscribeToUp","_onUpSubscribers","notifyDragSubscribers","_mouseMoveData","notifyDownSubscribers","notifyUpSubscribers","_isHeld","_isMoving","_isDragging","_startEvent","onMove","updateMouseMoveData","startData","eventData","_root","../throttle/throttle.js",9,"Preview","croppedImageData","buffer","bufferCtx","putImageData","toDataURL","previewElement","toLowerCase","backgroundImage",10,"Settings","userSettings","TypeError","ifValue","isElement","querySelector","contains","body","prototype","toString","ratioArrayToObject","test","ratios",11,"Throttle","callback","time","timeout","wait","setTimeout",12,"utils","bytesToSize","bytes","sizes","parseInt","floor","log","round","pow","onReaderLoad","result","reader","FileReader","readAsDataURL","base64String","blobBin","atob","split","array","charCodeAt","Uint8Array","value","HTMLElement","nodeType","nodeName","closedElements","closedRegex","RegExp","join"],"mappings":"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","file":"crop-resize-0.1.2.min.js","sourcesContent":["(function e(t, n, r) {\n    function s(o, u) {\n        if (!n[o]) {\n            if (!t[o]) {\n                var a = typeof require == \"function\" && require;\n                if (!u && a) return a(o, !0);\n                if (i) return i(o, !0);\n                var f = new Error(\"Cannot find module '\" + o + \"'\");\n                throw f.code = \"MODULE_NOT_FOUND\", f\n            }\n            var l = n[o] = {\n                exports: {}\n            };\n            t[o][0].call(l.exports, function(e) {\n                var n = t[o][1][e];\n                return s(n ? n : e)\n            }, l, l.exports, e, t, n, r)\n        }\n        return n[o].exports\n    }\n    var i = typeof require == \"function\" && require;\n    for (var o = 0; o < r.length; o++) s(r[o]);\n    return s\n})({\n    1: [function(require, module, exports) {\n        (function(document, window) {\n\n            window['CropResize'] = CropResize;\n\n            function CropResize(cropArea, attributes) {\n\n                var _application = {};\n\n                /*========================================================================\n                    PUBLIC\n                ========================================================================*/\n                _application.destroy = destroy;\n                _application.getInfo = getInfo;\n\n                /*========================================================================\n                    PRIVATE\n                ========================================================================*/\n                var _settings = require('./components/settings/settings.js');\n\n                _settings.bindSettings(cropArea, attributes);\n                var _eventsQueue = require('./components/events-queue/events-queue.js'),\n                    _information = require('./components/information/information.js'),\n                    _dragDrop = require('./components/drag-drop/drag-drop.js'),\n                    _cropWindow = require('./components/crop-window/crop-window.js'),\n                    _cropArea = require('./components/crop-area/crop-area.js'),\n                    _fileUpload = require('./components/file-upload/file-upload.js');\n\n                _fileUpload.onFileChange(onFileProcessed);\n                _dragDrop.onFileChange(onFileProcessed);\n                _cropArea.onChange(updateCropWindow);\n\n                return _application;\n\n                function updateCropWindow(canvasData) {\n                    _cropWindow.init();\n                    _cropWindow.updateContext(canvasData);\n                }\n\n                function onFileProcessed(file) {\n                    _information.resetData();\n                    _information.updateProperty('originalImage', file);\n                    _information.updateProperty('croppedImage', {\n                        type: file.type,\n                        name: file.name\n                    });\n                    _cropArea.changeFile(file);\n                }\n\n                function getInfo() {\n                    _information.updateDataFor('croppedImage');\n\n                    return _information.getImageData();\n                }\n\n                function destroy() {\n                    _eventsQueue.removeAll();\n                    _application = null;\n                }\n            }\n\n        })(document, window);\n    }, {\n        \"./components/crop-area/crop-area.js\": 2,\n        \"./components/crop-window/crop-window.js\": 3,\n        \"./components/drag-drop/drag-drop.js\": 4,\n        \"./components/events-queue/events-queue.js\": 5,\n        \"./components/file-upload/file-upload.js\": 6,\n        \"./components/information/information.js\": 7,\n        \"./components/settings/settings.js\": 10\n    }],\n    2: [function(require, module, exports) {\n        (function() {\n            module.exports = CropArea();\n\n            function CropArea() {\n\n                var _eventsQueue = require('../events-queue/events-queue.js'),\n                    _utils = require('../utils/utils.js'),\n                    _settings = require('../settings/settings.js'),\n                    _information = require('../information/information.js'),\n                    _this = {},\n                    _hasInit = false,\n                    _onChangeQueue = [],\n                    _image = new Image(),\n                    _canvasElement,\n                    _source,\n                    _canvas,\n                    _context;\n\n                /*========================================================================\n                    PUBLIC\n                ========================================================================*/\n\n                _this.changeFile = changeFile;\n                _this.onChange = storeOnChange;\n\n                return _this;\n\n                /*========================================================================\n                    PRIVATE\n                ========================================================================*/\n\n                function init() {\n                    createCanvasElement();\n                    bindListeners();\n                    _hasInit = true;\n                }\n\n                function changeFile(file) {\n                    if (!_hasInit) {\n                        init();\n                    }\n                    _utils.fileToBase64(file, function(src) {\n                        _information.updateProperty('originalImage', {\n                            src: src,\n                            file: _utils.base64toBlob(src)\n                        });\n                        _image.src = src;\n                    });\n                }\n\n                function bindListeners() {\n                    _image.onload = onCanvasSrcLoad;\n                    _eventsQueue.subscribe('resize', window, cacheCanvasDimensions);\n                }\n\n                function createCanvasElement() {\n\n                    var cropArea = _settings.cropArea,\n                        tagName;\n\n                    if (cropArea) {\n                        tagName = cropArea.tagName.toLocaleLowerCase();\n\n                        if (_settings.cropArea && !_utils.isClosedElement(_settings.cropArea)) {\n                            if (tagName !== \"canvas\") {\n                                _canvasElement = document.createElement('canvas');\n                                cropArea.appendChild(_canvasElement);\n                            } else {\n                                _canvasElement = _settings.cropArea;\n                            }\n\n                            _context = _canvasElement.getContext('2d');\n                        }\n                    }\n                }\n\n                function onCanvasSrcLoad(e) {\n\n                    var canvasParams;\n\n                    _information.updateProperty('originalImage', {\n                        width: this.width,\n                        height: this.height\n                    });\n\n                    //Without a set size on the canvas the image data context with render at it's default dimensions of 300x150.\n                    //CSS will then scale the scaled down image data up to the size that it calculates for the DOM.\n                    _canvasElement.width = _canvasElement.offsetWidth;\n                    _canvasElement.height = _canvasElement.offsetHeight;\n\n                    _source = {};\n                    _canvas = {};\n\n                    _source['width'] = this.width;\n                    _source['height'] = this.height;\n\n                    _canvas['width'] = _canvasElement.width;\n                    _canvas['height'] = _canvasElement.height;\n\n                    canvasParams = measureContext();\n\n                    _canvas['widthRatio'] = (canvasParams.asObject.dWidth / _canvas['width']);\n                    _canvas['heightRatio'] = (canvasParams.asObject.dHeight / _canvas['height']);\n\n                    _context.clearRect(0, 0, _canvas.width, _canvas.height);\n\n                    canvasParams.asArray.unshift(_image);\n                    _context.drawImage.apply(_context, canvasParams.asArray);\n                    cacheCanvasDimensions();\n                    notify(canvasParams);\n                }\n\n                function storeOnChange(fn) {\n                    _onChangeQueue.push(fn);\n                }\n\n                function notify(canvasParams) {\n                    var totalSubscribers = _onChangeQueue.length;\n                    while (totalSubscribers--) {\n                        if (_onChangeQueue[totalSubscribers] && typeof _onChangeQueue[totalSubscribers] === 'function') {\n                            _onChangeQueue[totalSubscribers]({\n                                source: _source,\n                                canvas: _canvas,\n                                context: _context,\n                                canvasParams: canvasParams\n                            });\n                        }\n                    }\n                }\n\n                function cacheCanvasDimensions() {\n                    if (_canvasElement && _canvas) {\n                        var canvasBounding = _canvasElement.getBoundingClientRect();\n                        _canvas['top'] = canvasBounding.top;\n                        _canvas['left'] = canvasBounding.left;\n                        _canvas['cWidth'] = _canvasElement.offsetWidth;\n                        _canvas['cHeight'] = _canvasElement.offsetHeight;\n                    }\n                }\n\n                function measureContext() {\n                    var hRatio = _canvas.width / _source.width,\n                        vRatio = _canvas.height / _source.height,\n                        ratio = Math.min(hRatio, vRatio),\n                        paramsAsObject = {\n                            sx: 0,\n                            sy: 0,\n                            sWidth: _source.width,\n                            sHeight: _source.height,\n                            dx: (_canvas.width - _source.width * ratio) / 2,\n                            dy: (_canvas.height - _source.height * ratio) / 2,\n                            dWidth: _source.width * ratio,\n                            dHeight: _source.height * ratio\n                        };\n                    return {\n                        asObject: paramsAsObject,\n                        asArray: Object.keys(paramsAsObject).map(function(key) {\n                            return paramsAsObject[key]\n                        })\n                    }\n                }\n            }\n        })();\n    }, {\n        \"../events-queue/events-queue.js\": 5,\n        \"../information/information.js\": 7,\n        \"../settings/settings.js\": 10,\n        \"../utils/utils.js\": 12\n    }],\n    3: [function(require, module, exports) {\n        (function() {\n            module.exports = CropWindowDependencies();\n\n            function CropWindowDependencies() {\n\n                var _settings = require('../settings/settings.js'),\n                    _preview = require('../preview/preview.js'),\n                    _mouseEvents = require('../mouse-events/mouse-events.js'),\n                    _this = {},\n                    _hasInit = false,\n                    _translate = {},\n                    _handles = Handles(),\n                    _source,\n                    _focusElement,\n                    _canvasParams,\n                    cropWindowElement = document.createElement('div'),\n                    baseWidth,\n                    baseHeight,\n                    canvas,\n                    context;\n\n                /*========================================================================\n                    PUBLIC\n                ========================================================================*/\n                _this.init = createCropWindow;\n                _this.updateContext = updateContext;\n                _this.isHeld = false;\n\n                return _this;\n                /*========================================================================\n                    PRIVATE\n                ========================================================================*/\n\n                function updateContext(cropData) {\n                    canvas = cropData.canvas;\n                    context = cropData.context;\n                    _source = cropData.source;\n                    _canvasParams = cropData.canvasParams;\n                    cropWindowElement.setAttribute('style', '');\n                }\n\n                function createCropWindow() {\n                    if (!_hasInit) {\n                        _mouseEvents.onDrag(onCropMove);\n                        _mouseEvents.onDown(onCropMouseDown);\n                        _mouseEvents.onUp(onCropMouseUp);\n\n                        cropWindowElement.className = 'cr-crop-window';\n\n                        for (var i = 0; i < _handles.length; i++) {\n                            (function() {\n                                var cropHandle = document.createElement('div');\n                                cropHandle.className = \"cr-crop-handle cr-\" + _handles[i].class;\n                                _handles[i].element = cropHandle;\n                                cropWindowElement.appendChild(cropHandle);\n                            })();\n                        }\n\n                        _settings.cropArea.appendChild(cropWindowElement);\n\n                        baseWidth = cropWindowElement.clientWidth;\n                        baseHeight = cropWindowElement.clientHeight;\n\n                        //We choose to set the ratio to the smallest size it could be at the give ratio.\n                        if (_settings.setRatio) {\n                            if (_settings.setRatio.hRatio > _settings.setRatio.wRatio) {\n                                baseHeight = (cropWindowElement.clientWidth * _settings.setRatio.wRatio);\n                            } else {\n                                baseWidth = (cropWindowElement.clientHeight * _settings.setRatio.hRatio);\n                            }\n                        }\n\n                        //TODO:Center this and save measurements for reset\n\n                        cropWindowElement.style.height = baseHeight + \"px\";\n                        cropWindowElement.style.width = baseWidth + \"px\";\n\n                        _hasInit = true;\n                    }\n                }\n\n                function onCropMove(mouseMoveData, force) {\n                    if (_this.isHeld || force) {\n                        var widthOffset = canvas.cWidth - (canvas.cWidth * canvas.widthRatio),\n                            heightOffset = canvas.cHeight - (canvas.cHeight * canvas.heightRatio),\n                            maxLeft = (cropWindowElement.offsetLeft * -1) + (widthOffset / 2),\n                            maxTop = (cropWindowElement.offsetTop * -1) + (heightOffset / 2),\n                            maxRight = (cropWindowElement.offsetLeft - (cropWindowElement.clientWidth - baseWidth)) - (widthOffset / 2),\n                            maxBottom = (cropWindowElement.offsetTop - (cropWindowElement.clientHeight - baseHeight)) - (heightOffset / 2),\n                            canvasWidth = canvas.cWidth,\n                            canvasHeight = canvas.cHeight,\n                            newX = (_translate.x + mouseMoveData.x),\n                            newY = (_translate.y + mouseMoveData.y),\n                            newWidth = cropWindowElement.offsetWidth,\n                            newHeight = cropWindowElement.offsetHeight,\n                            maxHeight,\n                            maxWidth;\n\n                        if (newX < maxLeft) {\n                            newX = maxLeft;\n                        }\n                        if (newX > maxRight) {\n                            newX = maxRight;\n                        }\n                        if (newY < maxTop) {\n                            newY = maxTop;\n                        }\n                        if (newY > maxBottom) {\n                            newY = maxBottom;\n                        }\n\n                        if (_focusElement === cropWindowElement || force) {\n                            applyTransform(_translate.scaleX, _translate.skewX, _translate.skewY, _translate.scaleY, newX, newY);\n                        } else {\n\n                            if (_focusElement.class.match(/left/g)) {\n                                maxWidth = (canvasWidth - (canvasWidth - (_translate.width + (cropWindowElement.offsetLeft + _translate.x)))) - (widthOffset / 2);\n                            }\n                            if (_focusElement.class.match(/right/g)) {\n                                maxWidth = (canvasWidth - (cropWindowElement.offsetLeft + _translate.x)) - (widthOffset / 2);\n                                newWidth = Math.min(_translate.width + mouseMoveData.x, maxWidth);\n                            }\n                            if (_focusElement.class.match(/bottom/g)) {\n                                maxHeight = (canvasHeight - (cropWindowElement.offsetTop + _translate.y)) - (heightOffset / 2);\n                                newHeight = Math.min((_translate.height + mouseMoveData.y), maxHeight);\n                            }\n                            if (_focusElement.class.match(/top/g)) {\n                                maxHeight = (canvasHeight - (canvasHeight - (_translate.height + (cropWindowElement.offsetTop + _translate.y)))) - (heightOffset / 2);\n                            }\n                            if (_focusElement.class.match(/top-left/g)) {\n                                newWidth = Math.min(_translate.width - mouseMoveData.x, maxWidth);\n                                newHeight = Math.min((_translate.height - mouseMoveData.y), maxHeight);\n                            } else if (_focusElement.class.match(/top/g)) {\n                                newHeight = Math.min((_translate.height - mouseMoveData.y), maxHeight);\n                                newX = _translate.x;\n                            } else if (_focusElement.class.match(/left/g)) {\n                                newWidth = Math.min(_translate.width - mouseMoveData.x, maxWidth);\n                                newY = _translate.y;\n                            }\n\n                            if (newWidth > 0 && newHeight > 0) {\n                                cropWindowElement.style.width = newWidth;\n                                cropWindowElement.style.height = newHeight;\n                                if (_focusElement.class.match(/left|top/g)) {\n                                    applyTransform(_translate.scaleX, _translate.skewX, _translate.skewY, _translate.scaleY, newX, newY);\n                                }\n                            }\n                        }\n                        generatePreviewDimensions();\n                    }\n                }\n\n                function applyTransform(scaleX, skewX, skewY, scaleY, x, y) {\n                    cropWindowElement.style['transform' || 'webkitTransform' || 'mozTransform'] = \"matrix(\" + scaleX + \",\" + skewX + \",\" + skewY + \",\" + scaleY + \",\" + x + \", \" + y + \")\";\n                }\n\n                function generatePreviewDimensions() {\n                    var canvasWidth = canvas.cWidth,\n                        canvasHeight = canvas.cHeight,\n                        heightPercent = cropWindowElement.clientHeight / canvasHeight,\n                        widthPercent = cropWindowElement.clientWidth / canvasWidth,\n                        leftPercent = (cropWindowElement.getBoundingClientRect().left - canvas.left) / canvasWidth,\n                        topPercent = (cropWindowElement.getBoundingClientRect().top - canvas.top) / canvasHeight,\n                        newWidth = canvas.width * widthPercent,\n                        newHeight = canvas.height * heightPercent,\n                        newX = canvas.width * leftPercent,\n                        newY = canvas.height * topPercent,\n                        newImgData;\n\n                    if (newX > 0 && newY > 0 && newWidth > 0 && newHeight > 0) {\n                        newImgData = context.getImageData(\n                            newX,\n                            newY,\n                            newWidth,\n                            newHeight);\n                        _preview.createImgInstance(newImgData, newWidth, newHeight);\n                    }\n                }\n\n                function onCropMouseDown(e) {\n                    if (e.target.className.match(\"-crop-\")) {\n\n                        var transform = (window.getComputedStyle(cropWindowElement)['transform' || 'webkitTransform' || 'mozTransform'].match(/-?\\d+(?:\\.\\d+)?/g)) || [];\n\n                        _this.isHeld = true;\n                        _translate['scaleX'] = Number(transform[0] || 1);\n                        _translate['skewX'] = Number(transform[1] || 0);\n                        _translate['skewY'] = Number(transform[2] || 0);\n                        _translate['scaleY'] = Number(transform[3] || 1);\n                        _translate['x'] = Number(transform[4] || 0);\n                        _translate['y'] = Number(transform[5] || 0);\n                        _translate['width'] = cropWindowElement.offsetWidth;\n                        _translate['height'] = cropWindowElement.offsetHeight;\n                        _focusElement = null;\n\n                        if (e.target === cropWindowElement || e.target.className.match(/center-point/gi)) {\n                            _focusElement = cropWindowElement;\n                        } else {\n                            for (var i = 0; i < _handles.length; i++) {\n                                if (e.target === _handles[i].element) {\n                                    _focusElement = _handles[i];\n                                    break;\n                                }\n                            }\n                        }\n                    }\n                }\n\n                function onCropMouseUp(e) {\n                    _this.isHeld = false;\n                    _focusElement = null;\n                }\n\n                function Handles() {\n                    return [\n                        handleObject('handle-top-left'),\n                        handleObject('handle-top-center'),\n                        handleObject('handle-top-right'),\n                        handleObject('handle-right-middle'),\n                        handleObject('handle-bottom-right'),\n                        handleObject('handle-bottom-center'),\n                        handleObject('handle-bottom-left'),\n                        handleObject('handle-left-middle'),\n                        handleObject('center-point')\n                    ];\n\n                    function handleObject(className) {\n                        return {\n                            \"class\": className\n                        }\n                    }\n                }\n            }\n        })();\n    }, {\n        \"../mouse-events/mouse-events.js\": 8,\n        \"../preview/preview.js\": 9,\n        \"../settings/settings.js\": 10\n    }],\n    4: [function(require, module, exports) {\n        (function() {\n            module.exports = DragDropDependencies();\n\n            function DragDropDependencies() {\n\n                var _eventsQueue = require('../events-queue/events-queue.js'),\n                    _settings = require('../settings/settings.js'),\n                    _cropWindow = require('../crop-window/crop-window.js'),\n                    _subscribers = [],\n                    _this = {},\n                    focusClassName = 'drag-over';\n\n                /*========================================================================\n                    PUBLIC\n                ========================================================================*/\n\n                _this.onFileChange = onFileChange;\n                init();\n\n                return _this;\n\n                /*========================================================================\n                    PRIVATE\n                ========================================================================*/\n\n                function init() {\n                    if (_settings.dropArea) {\n                        _eventsQueue.subscribe('drop', _settings.dropArea, onDrop);\n                        _eventsQueue.subscribe('dragover', _settings.dropArea, onDragOver);\n                        _eventsQueue.subscribe('dragleave', _settings.dropArea, onDragLeave);\n                        _eventsQueue.subscribe('dragenter', _settings.dropArea, onDragEnter);\n                    }\n                }\n\n                function onFileChange(fn) {\n                    _subscribers.push(fn);\n                }\n\n                function onDrop(e) {\n                    e.preventDefault();\n\n                    var data = e.dataTransfer.files,\n                        totalSubscribers = _subscribers.length;\n\n                    if (data[0] instanceof Blob) {\n                        while (totalSubscribers--) {\n                            if (_subscribers[totalSubscribers] && typeof _subscribers[totalSubscribers] === 'function') {\n                                _subscribers[totalSubscribers](data[0]);\n                            }\n                        }\n                    }\n                }\n\n                function onDragOver(e) {\n                    if (!_cropWindow.isHeld) {\n                        e.preventDefault();\n                        e.dataTransfer.dropEffect = 'copy';\n                    }\n                }\n\n                function onDragEnter(e) {\n                    if (!_cropWindow.isHeld) {\n                        _settings.dropArea.classList.add(focusClassName);\n                    }\n                }\n\n                function onDragLeave(e) {\n                    if (!_cropWindow.isHeld) {\n                        _settings.dropArea.classList.remove(focusClassName);\n                    }\n                }\n\n            }\n        })();\n    }, {\n        \"../crop-window/crop-window.js\": 3,\n        \"../events-queue/events-queue.js\": 5,\n        \"../settings/settings.js\": 10\n    }],\n    5: [function(require, module, exports) {\n        (function() {\n            module.exports = EventsQueue();\n\n            function EventsQueue() {\n\n                var _queue = [],\n                    _eventsQueue = {};\n\n                /*========================================================================\n                    PUBLIC\n                ========================================================================*/\n                _eventsQueue.subscribe = subscribe;\n                _eventsQueue.removeAll = removeAll;\n                _eventsQueue.triggerEvent = triggerEvent;\n\n                return _eventsQueue;\n\n                /*========================================================================\n                    PRIVATE\n                ========================================================================*/\n\n                function subscribe(eventName, element, subscriberFn) {\n                    var knownQueueItem;\n                    for (var i = 0; i < _queue.length; i++) {\n                        if (_queue[i].eventName === eventName && _queue[i].element === element) {\n                            _queue[i].events.push(subscriberFn);\n                            knownQueueItem = _queue[i];\n                            break;\n                        }\n                    }\n                    return (knownQueueItem || new EventObject(eventName, element, subscriberFn))['publicEvents'];\n                }\n\n                function triggerEvent(eventName, element) {\n                    var l = _queue.length;\n                    while (l--) {\n                        if (_queue[l].element === element && _queue[l].eventName === eventName) {\n                            _queue[l].publicEvents.trigger();\n                            return;\n                        }\n                    }\n                }\n\n                function EventObject(eventName, element, subscriberFn) {\n\n                    var queueObject = {\n                            events: [subscriberFn],\n                            element: element,\n                            eventName: eventName,\n                            publicEvents: {\n                                unSubscribe: unSubscribe,\n                                trigger: trigger\n                            }\n                        },\n                        customEvent = document.createEvent('Event');\n\n                    customEvent.initEvent(eventName, true, true);\n                    element.addEventListener(eventName, onEvent);\n                    _queue.push(queueObject);\n\n                    return queueObject;\n\n                    function onEvent(e) {\n                        for (var i = 0; i < queueObject.events.length; i++) {\n                            queueObject.events[i].call(this, e);\n                        }\n                    }\n\n                    function trigger() {\n                        element.dispatchEvent(customEvent);\n                    }\n\n                    function unSubscribe() {\n\n                        var functionIdx = queueObject.events.indexOf(subscriberFn);\n\n                        if (functionIdx > -1 && queueObject) {\n                            queueObject.events.splice(functionIdx, 1);\n                        }\n\n                        if (queueObject.events.length <= 0) {\n                            element.removeEventListener(eventName, onEvent);\n                            _queue.splice(_queue.indexOf(queueObject), 1);\n                        }\n                    }\n                }\n\n                function removeAll() {\n                    var l = _queue.length;\n                    while (l--) {\n                        _queue[l].publicEvents.unSubscribe();\n                    }\n                }\n            }\n        })();\n    }, {}],\n    6: [function(require, module, exports) {\n        (function() {\n            \"use strict\";\n\n            module.exports = FileInput();\n\n            function FileInput() {\n\n                var _eventsQueue = require('../events-queue/events-queue.js'),\n                    _settings = require('../settings/settings.js'),\n                    _subscribers = [],\n                    _this = {};\n\n                /*========================================================================\n                    PUBLIC\n                ========================================================================*/\n\n                init();\n                _this.onFileChange = storeSubscriber;\n\n                return _this;\n                /*========================================================================\n                    PRIVATE\n                ========================================================================*/\n\n                function init() {\n                    _eventsQueue.subscribe('change', _settings.fileInput, onFileInputChange);\n                }\n\n                function storeSubscriber(fn) {\n                    _subscribers.push(fn);\n                }\n\n                function notifySubscribers(file) {\n                    var totalSubscribers = _subscribers.length;\n                    while (totalSubscribers--) {\n                        if (_subscribers[totalSubscribers] && typeof _subscribers[totalSubscribers] === 'function') {\n                            _subscribers[totalSubscribers](file);\n                        }\n                    }\n                }\n\n                function onFileInputChange(e) {\n                    var files = this.files;\n\n                    for (var file in files) {\n                        if (files[file] instanceof Blob) {\n                            return notifySubscribers(files[file]);\n                        }\n                    }\n                }\n            }\n        })();\n    }, {\n        \"../events-queue/events-queue.js\": 5,\n        \"../settings/settings.js\": 10\n    }],\n    7: [function(require, module, exports) {\n        (function() {\n            \"use strict\";\n\n            module.exports = Information();\n\n            function Information() {\n\n                var _this = {},\n                    _utils = require('../utils/utils.js'),\n                    _data = {\n                        croppedImage: imageInfoObject(),\n                        originalImage: imageInfoObject()\n                    };\n\n                _this.getImageData = getImageData;\n                _this.updateDataFor = updateDataFor;\n                _this.updateProperty = updateProperty;\n                _this.resetData = resetData;\n\n                return _this;\n\n                function getImageData() {\n                    return {\n                        croppedImage: _data.croppedImage,\n                        originalImage: _data.originalImage\n                    }\n                }\n\n                function updateDataFor(property) {\n                    var data = _data[property];\n                    if (data && data.src !== \"\") {\n                        data.file = _utils.base64toBlob(data.src);\n                    }\n                }\n\n                function resetData() {\n                    _data = {\n                        croppedImage: imageInfoObject(),\n                        originalImage: imageInfoObject()\n                    };\n                }\n\n                function updateProperty(property, values) {\n                    if (_data[property]) {\n                        for (var key in _data[property]) {\n                            if (values[key]) {\n                                _data[property][key] = values[key];\n                            }\n                        }\n                    }\n                }\n\n                function imageInfoObject() {\n                    return {\n                        src: \"\",\n                        file: null,\n                        size: 0,\n                        type: \"\",\n                        name: \"\",\n                        width: 0,\n                        height: 0\n                    }\n                }\n            }\n        })();\n    }, {\n        \"../utils/utils.js\": 12\n    }],\n    8: [function(require, module, exports) {\n        (function() {\n\n            module.exports = MouseEvents(\n                require('../events-queue/events-queue.js'),\n                require('../throttle/throttle.js')\n            );\n\n            function MouseEvents(_eventsQueue, _throttle) {\n\n                /*----------------------------------------------------------------------\n                    PRIVATE VARIABLES\n                 ----------------------------------------------------------------------*/\n                var _root = {},\n                    _dragSubscribers = [],\n                    _onDownSubscribers = [],\n                    _onUpSubscribers = [],\n                    _isHeld = false,\n                    _isMoving = false,\n                    _isDragging = false,\n                    _mouseMoveData = {},\n                    _startEvent;\n\n                /*----------------------------------------------------------------------\n                    PUBLIC METHODS\n                ----------------------------------------------------------------------*/\n\n                _root.isHeld = isHeld;\n                _root.onDrag = subscribeToDrag;\n                _root.onDown = subscribeToDown;\n                _root.onUp = subscribeToUp;\n\n                /*----------------------------------------------------------------------\n                    INIT\n                ----------------------------------------------------------------------*/\n\n                init();\n                return _root;\n\n                /*----------------------------------------------------------------------\n                    PRIVATE METHODS\n                 ----------------------------------------------------------------------*/\n\n                function init() {\n                    _eventsQueue.subscribe(\"mousedown\", window, mouseDownHandler);\n                    _eventsQueue.subscribe(\"mouseup\", window, mouseUpHandler);\n                    _eventsQueue.subscribe(\"mousemove\", window, onMouseMoveHandler);\n                    _eventsQueue.subscribe(\"dragstart\", window, onDragStartHandler);\n                    _eventsQueue.subscribe(\"dragend\", window, onDragEndHandler);\n                    _eventsQueue.subscribe(\"drag\", window, _throttle(onDragHandler, 50));\n                }\n\n                function subscribeToDrag(fn) {\n                    _dragSubscribers.push(fn);\n                }\n\n                function subscribeToDown(fn) {\n                    _onDownSubscribers.push(fn);\n                }\n\n                function subscribeToUp(fn) {\n                    _onUpSubscribers.push(fn);\n                }\n\n                function notifyDragSubscribers() {\n                    for (var i = 0; i < _dragSubscribers.length; i++) {\n                        _dragSubscribers[i](_mouseMoveData)\n                    }\n                }\n\n                function notifyDownSubscribers(e) {\n                    for (var i = 0; i < _onDownSubscribers.length; i++) {\n                        _onDownSubscribers[i](e);\n                    }\n                }\n\n                function notifyUpSubscribers(e) {\n                    for (var i = 0; i < _onUpSubscribers.length; i++) {\n                        _onUpSubscribers[i](e);\n                    }\n                }\n\n                function isHeld() {\n                    return _isHeld;\n                }\n\n                function mouseDownHandler(e) {\n                    onDown(e);\n                    _isHeld = true;\n                    _isMoving = true\n                }\n\n                function onDragStartHandler(e) {\n                    onDown(e);\n                    _isHeld = true;\n                    _isDragging = true;\n                }\n\n                function onDown(e) {\n                    if (!_startEvent) {\n                        _startEvent = e;\n                        notifyDownSubscribers(e);\n                    }\n                }\n\n                function mouseUpHandler(e) {\n                    _isMoving = false;\n                    if (!_isDragging) {\n                        onUp(e);\n                    }\n                }\n\n                function onDragEndHandler(e) {\n                    _isMoving = false;\n                    _isDragging = false;\n                    onUp(e);\n                }\n\n                function onUp(e) {\n                    _startEvent = null;\n                    _isHeld = false;\n                    notifyUpSubscribers(e);\n                }\n\n                function onDragHandler(e) {\n                    onMove(e);\n                }\n\n                function onMouseMoveHandler(e) {\n                    if (!_isDragging) {\n                        onMove(e);\n                    }\n                }\n\n                function onMove(e) {\n                    if (_isHeld) {\n                        updateMouseMoveData(_startEvent, e);\n                        notifyDragSubscribers(e);\n                    }\n                }\n\n                function updateMouseMoveData(startData, eventData) {\n                    if (eventData.x !== 0) {\n                        _mouseMoveData = {\n                            x: eventData.x - startData.x,\n                            y: eventData.y - startData.y\n                        }\n                    }\n                }\n            }\n        })();\n    }, {\n        \"../events-queue/events-queue.js\": 5,\n        \"../throttle/throttle.js\": 11\n    }],\n    9: [function(require, module, exports) {\n        (function() {\n            \"use strict\";\n\n            module.exports = Preview();\n\n            function Preview() {\n\n                var _this = {},\n                    _utils = require('../utils/utils.js'),\n                    _settings = require('../settings/settings.js'),\n                    _information = require('../information/information.js');\n\n                _this.createImgInstance = createImgInstance;\n\n                return _this;\n\n                function createImgInstance(croppedImageData, width, height) {\n                    var buffer = document.createElement('canvas'),\n                        bufferCtx = buffer.getContext(\"2d\"),\n                        src;\n\n                    buffer.width = width;\n                    buffer.height = height;\n                    bufferCtx.putImageData(croppedImageData, 0, 0);\n\n                    src = buffer.toDataURL('image/png', 1);\n\n                    if (src) {\n                        _information.updateProperty('croppedImage', {\n                            src: src,\n                            width: width,\n                            height: height\n                        });\n\n                        if (_settings.previewElement) {\n                            if (_settings.previewElement.tagName.toLowerCase() === 'img') {\n                                _settings.previewElement.src = src;\n                            } else if (!_utils.isClosedElement(_settings.previewElement)) {\n                                _settings.previewElement.style.backgroundImage = \"url('\" + src + \"')\";\n                            }\n                        }\n                    }\n\n                }\n            }\n        })();\n    }, {\n        \"../information/information.js\": 7,\n        \"../settings/settings.js\": 10,\n        \"../utils/utils.js\": 12\n    }],\n    10: [function(require, module, exports) {\n        (function() {\n            module.exports = Settings();\n\n            function Settings() {\n\n                var body = document.querySelector('body'),\n                    _utils = require('../utils/utils.js'),\n                    _this = {\n                        fileInput: null,\n                        cropArea: null,\n                        croppedImage: {},\n                        dropArea: null,\n                        previewElement: null,\n                        setRatio: null\n                    };\n\n                _this.bindSettings = bindSettings;\n\n                return _this;\n\n                function bindSettings(cropArea, userSettings) {\n                    /**\n                     * cropArea or fileInput must be available.\n                     */\n                    if (!userSettings.fileInput && !userSettings.dropArea) {\n                        throw new TypeError(\"CropResize is unable to operate without a 'fileInput' or 'dropArea' element.\");\n                    }\n\n                    /**\n                     * cropArea value validation.\n\n                    */\n                    if (_utils.ifValue(cropArea).isElement && document.querySelector('body').contains(cropArea)) {\n                        if (!_utils.isClosedElement(cropArea)) {\n                            _this.cropArea = cropArea;\n                        } else {\n                            throw new TypeError(\"Unable to add child element canvas to element type '\" + cropArea.tagName + \"'.\");\n                        }\n                    } else {\n                        throw new TypeError(\"Invalid 'cropArea' element supplied to cropResize. Please ensure element is available in the DOM.\");\n                    }\n\n                    /**\n                     * fileInput value validation.\n                     */\n                    if (userSettings.fileInput) {\n                        if (_utils.ifValue(userSettings.fileInput).isElement && body.contains(userSettings.fileInput) && userSettings.fileInput.tagName.toLowerCase() === 'input' && userSettings.fileInput.type === 'file') {\n                            _this.fileInput = userSettings.fileInput;\n                        } else {\n                            throw new TypeError(\"Invalid 'fileInput' element supplied to cropResize. Please ensure element is available in the DOM.\");\n                        }\n                    }\n\n                    /**\n                     * dropArea value validation.\n                     */\n                    if (userSettings.dropArea) {\n                        if (_utils.ifValue(userSettings.dropArea).isElement && body.contains(userSettings.dropArea)) {\n                            _this.dropArea = userSettings.dropArea;\n                        } else if (userSettings.dropArea === true) {\n                            _this.dropArea = userSettings.cropArea;\n                        } else {\n                            throw new TypeError(\"Unable to assign parameter \" + userSettings.dropArea + \" to 'dropArea'. Please ensure value is an element available in the DOM.\");\n                        }\n                    }\n\n                    /**\n                     * previewElement value validation.\n                     */\n                    if (userSettings.previewElement && _utils.ifValue(userSettings.previewElement).isElement && body.contains(userSettings.previewElement)) {\n                        _this.previewElement = userSettings.previewElement;\n                    }\n\n                    /**\n                     * Ratio value validation.\n                     */\n                    if (userSettings.setRatio) {\n                        if (Object.prototype.toString.call(userSettings.setRatio) === '[object Array]') {\n                            if (userSettings.setRatio.length >= 2 && typeof userSettings.setRatio[0] === 'number' && typeof userSettings.setRatio[1] === 'number') {\n                                _this.setRatio = ratioArrayToObject(userSettings.setRatio);\n                            } else {\n                                throw new TypeError(\"'setRatio' requires and array with two valid number values.\");\n                            }\n                        } else if (typeof userSettings.setRatio === \"string\" && (/\\d+/gi.test(userSettings.setRatio))) {\n                            _this.setRatio = ratioArrayToObject(userSettings.setRatio.match(/\\d+/gi));\n                        } else {\n                            throw new TypeError(\"'setRatio' must be a string containing two numbers separated by any non digit value.\");\n                        }\n                    }\n                }\n\n                function ratioArrayToObject(ratios) {\n                    return {\n                        hRatio: ratios[0] / ratios[1],\n                        wRatio: ratios[1] / ratios[0]\n                    };\n                }\n            }\n        })();\n    }, {\n        \"../utils/utils.js\": 12\n    }],\n    11: [function(require, module, exports) {\n        (function() {\n            module.exports = Throttle;\n\n            function Throttle(callback, time) {\n                var wait = false,\n                    timeout;\n\n                return function(e) {\n                    if (!wait) {\n                        callback(e);\n                        wait = true;\n                        timeout = setTimeout(function() {\n                            wait = false;\n                        }, time);\n                    }\n                }\n            }\n        })();\n    }, {}],\n    12: [function(require, module, exports) {\n        (function() {\n            module.exports = utils();\n\n            function utils() {\n\n                var utils = {};\n\n                utils.bytesToSize = bytesToSize;\n                utils.base64toBlob = base64toBlob;\n                utils.ifValue = ifValue;\n                utils.isClosedElement = isClosedElement;\n                utils.fileToBase64 = fileToBase64;\n\n                this.utils = utils;\n\n                return utils;\n\n                function bytesToSize(bytes) {\n                    var sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n                    if (bytes == 0) return '0 Byte';\n                    var i = parseInt(Math.floor(Math.log(bytes) / Math.log(1024)));\n                    return Math.round(bytes / Math.pow(1024, i), 2) + ' ' + sizes[i];\n                }\n\n                function fileToBase64(file, fn) {\n                    var reader = new FileReader();\n                    reader.onload = onReaderLoad;\n                    reader.readAsDataURL(file);\n\n                    function onReaderLoad(e) {\n                        fn(e.target.result);\n                    }\n                }\n\n                function base64toBlob(base64String) {\n                    var blobBin = atob(base64String.split(',')[1]),\n                        array = [];\n\n                    for (var i = 0; i < blobBin.length; i++) {\n                        array.push(blobBin.charCodeAt(i));\n                    }\n\n                    return new Blob([new Uint8Array(array)], {\n                        type: 'image/png'\n                    });\n                }\n\n                function ifValue(value) {\n\n                    return {\n                        isElement: isElement()\n                    };\n\n                    function isElement() {\n                        return typeof HTMLElement === \"object\" ? value instanceof HTMLElement : value && typeof value === \"object\" && value !== null && value.nodeType === 1 && typeof value.nodeName === \"string\";\n                    }\n                }\n\n                function isClosedElement(element) {\n                    var closedElements = [\n                            'area',\n                            'base',\n                            'br',\n                            'col',\n                            'command',\n                            'embed',\n                            'hr',\n                            'img',\n                            'input',\n                            'keygen',\n                            'link',\n                            'meta',\n                            'param',\n                            'source',\n                            'track',\n                            'wbr'\n                        ],\n                        closedRegex = new RegExp(\"^\" + closedElements.join(\"$|^\") + \"$\", 'gi');\n\n                    return (closedRegex.test(element.tagName));\n                }\n            }\n\n        })();\n    }, {}]\n}, {}, [1]);"],"sourceRoot":"/source/"}